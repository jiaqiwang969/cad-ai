# TraceParts CAD Scraper â€“ OpenAI & LangChain Demo é¡¹ç›®

> é€šè¿‡ **OpenAI GPT-4o** ä¸ **LangChain** é©±åŠ¨çš„æ™ºèƒ½åŒ–çˆ¬è™«ï¼Œè‡ªåŠ¨è·å– [TraceParts](https://www.traceparts.com/) äº§å“ç±»ç›®å¹¶å®Œæˆ CAD æ¨¡å‹ä¸‹è½½ã€‚
>
> é¡¹ç›®ç€é‡æ¼”ç¤ºä»¥ä¸‹èƒ½åŠ›ï¼š
>
> 1. OpenAI / LangChain æ¥å…¥æœ€ä½³å®è·µ
> 2. å¤šå±‚çº§åˆ†ç±»æ ‘é€’å½’çˆ¬å– & é«˜å¹¶å‘æŠ“å–
> 3. Playwright + Stealth è§„é¿æ£€æµ‹
> 4. **éªŒè¯ç è‡ªåŠ¨è¯†åˆ«**ï¼ˆæ”¯æŒ GPT-4o / TrOCR / pytesseractï¼‰
> 5. å®Œæ•´ä¸‹è½½é“¾è·¯ï¼šç™»å½• â†’ è§¦å‘ä¸‹è½½ â†’ å¤„ç†å‹ç¼©åŒ… â†’ æ•°æ®æŒä¹…åŒ–

---

## ç›®å½•ç»“æ„

```text
50-çˆ¬è™«01/
â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜ï¼ˆæœ¬æ–‡æ¡£ï¼‰
â”œâ”€â”€ Makefile                       # ä¸€é”®å®‰è£… / æµ‹è¯• / å·¥å…·å‘½ä»¤
â”œâ”€â”€ requirements.txt               # Python ä¾èµ–
â”œâ”€â”€ config.py                      # é…ç½®é¡¹ï¼ˆAPIã€æµè§ˆå™¨ã€æ—¥å¿—ç­‰ï¼‰
â”œâ”€â”€ utils/                         # é€šç”¨å·¥å…·ï¼ˆéªŒè¯ç è¯†åˆ«ç­‰ï¼‰
â”‚   â””â”€â”€ captcha_solver.py          # CaptchaSolver â€“ è¿”å› **åŸå§‹ OCR æ–‡æœ¬**
â”œâ”€â”€ test/                          # æµ‹è¯•è„šæœ¬ï¼ˆ01-10ï¼‰
â”‚   â””â”€â”€ intermediate/              # æ·±åº¦è°ƒç ”è„šæœ¬ï¼ˆ11+ï¼‰ï¼Œé»˜è®¤ä¸ä¼šéš Makefile æ‰§è¡Œ
â””â”€â”€ results/                       # è¿è¡Œäº§ç‰©ï¼ˆJSON / æˆªå›¾ / è°ƒè¯•å›¾ç­‰ï¼‰
```

### å…³äº CaptchaSolver

`utils/captcha_solver.py` **ä¸ä¼šå¯¹ OCR ç»“æœåšä»»ä½•å¤§å°å†™æˆ–é•¿åº¦è£å‰ª**ï¼Œå§‹ç»ˆè¿”å›æ¨¡å‹è¯†åˆ«åˆ°çš„åŸå§‹æ–‡æœ¬ã€‚
å¦‚æœéœ€è¦æ¸…æ´—ï¼Œå¯ä»¥åœ¨ä¸šåŠ¡ä¾§è‡ªè¡Œè°ƒç”¨ `str.upper()`ã€æ­£åˆ™æˆªå–ç­‰æ–¹å¼å¤„ç†ã€‚

---

## å¿«é€Ÿä¸Šæ‰‹

1. å…‹éš†ä»“åº“å¹¶è¿›å…¥ç›®å½•

   ```bash
   git clone <repo-url>
   cd 50-çˆ¬è™«01
   ```

2. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

   ```bash
   cp .env.example .env  # æŒ‰éœ€ä¿®æ”¹
   export $(grep -v '^#' .env | xargs)
   ```

3. å®‰è£…ä¾èµ–å¹¶æ‹‰å–æµè§ˆå™¨å†…æ ¸

   ```bash
   make install
   ```

4. è¿è¡Œæµ‹è¯•

   ```bash
   # è¿è¡Œå…¨éƒ¨ï¼ˆ01-10ï¼‰
   make test

   # åªè·‘åˆ†ç±»æ ‘é€’å½’çˆ¬å–ï¼ˆ06ï¼‰
   make test-06
   ```

> **æç¤º**ï¼šå¦‚éœ€ä½“éªŒæ›´é«˜çº§çš„è„šæœ¬ï¼ˆéªŒè¯ç è§„é¿ã€çœŸå®æµè§ˆå™¨ã€ä¸‹è½½è¯Šæ–­ç­‰ï¼‰ï¼Œè¯·è¿›å…¥ `test/intermediate/` æ‰‹åŠ¨æ‰§è¡Œç›¸åº”æ–‡ä»¶ã€‚

---

## æµ‹è¯•ç”¨ä¾‹ä¸€è§ˆ

| ç¼–å· | è„šæœ¬ | è¯´æ˜ |
|------|----------------------------------|-------------------------------------------------------------|
| 01 | `01-test_openai_api.py` | OpenAI Python SDK è¿é€šæ€§ & è®¡è´¹éªŒè¯ |
| 02 | `02-test_langchain_api.py` | LangChain Chat & Chain åŸºç¡€èƒ½åŠ› |
| 03 | `03-test_langchain_web_scraping.py` | æ™ºèƒ½ç½‘é¡µå—åˆ†æ + èšç„¦æå– |
| 04 | `04-test_async_web_scraping.py` | **å¼‚æ­¥å¹¶å‘** å¤šé¡µé¢é‡‡é›†ï¼Œå¯¹æ¯”æ€§èƒ½ |
| 05 | `05-test_category_drill_down.py` | ç±»ç›®æ·±åº¦é€’å½’ï¼Œè·å–å…¨éƒ¨å­åˆ†ç±»é“¾æ¥ |
| 06 | `06-test_classification_tree_recursive.py` | æ„å»º TraceParts **å®Œæ•´åˆ†ç±»æ ‘**ï¼ˆé€’å½’ç‰ˆï¼‰ |
| 07 | `07-test_classification_tree_nested.py` | æ„å»ºåµŒå¥—æ ‘ï¼ˆä¸€æ¬¡æ€§æå–å¹¶é‡ç»„ï¼‰ |
| 08 | `08-test_leaf_product_links.py` | æŠ½å–å¶èŠ‚ç‚¹äº§å“é“¾æ¥ |
| 09 | `09-test_batch_leaf_product_links.py` | æ‰¹é‡å¶èŠ‚ç‚¹æŠ“å– & ç»“æœå½’å¹¶ |
| **10** | `10-test_product_cad_download.py` | ğŸ **æ•´åˆæ¼”ç¤º**ï¼šç™»å½• + éªŒè¯ç è¯†åˆ« + CAD ä¸‹è½½ |

> æ—§çš„ 11-13 å·å®éªŒè„šæœ¬å·²è¿ç§»è‡³ `test/intermediate/`ï¼Œé»˜è®¤ä¸ä¼šéš `make test` æ‰§è¡Œï¼Œä½†ä»å¯å‚è€ƒã€‚

---

## å¸¸ç”¨å‘½ä»¤ï¼ˆMakefileï¼‰

| å‘½ä»¤ | æè¿° |
|------|------|
| `make install` | å®‰è£…ä¾èµ– + Playwright Chromium |
| `make test` | é¡ºåºæ‰§è¡Œ 01-10 å…¨å¥—æµ‹è¯• |
| `make test-0X` | åªè¿è¡ŒæŒ‡å®šç¼–å·è„šæœ¬ï¼Œä¾‹å¦‚ `make test-04` |
| `make check` | æ£€æŸ¥å…³é”®ä¾èµ–ç‰ˆæœ¬ |
| `make list` | åˆ—å‡º `test/` ç›®å½•è„šæœ¬ |
| `make results` | åˆ—å‡º `results/` ç”Ÿæˆæ–‡ä»¶ |
| `make clean` | ç§»é™¤ä¸´æ—¶ / ç»“æœæ–‡ä»¶ |
| `make help` | æŸ¥çœ‹å…¨éƒ¨å‘½ä»¤ |

---

## ç¯å¢ƒä¾èµ–

- Python 3.9+
- ç½‘ç»œå¯è®¿é—® OpenAI ä»£ç† (`https://ai.pumpkinai.online/v1`) åŠ TraceParts ç½‘ç«™
- å®Œæ•´ä¾èµ–è§ `requirements.txt`ï¼Œå…³é”®åŒ…ï¼š
  - openai, langchain, playwright, undetected-chromedriver
  - opencv-python, pillow, pytesseract, transformers, torch

---

## å¸¸è§é—®é¢˜

1. **å®‰è£…å¤±è´¥ / æƒé™ä¸è¶³** â€“ è¿½åŠ  `--break-system-packages` æˆ–ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒã€‚
2. **API 429 / 401** â€“ æ£€æŸ¥ä»£ç†åœ°å€ã€Key æ˜¯å¦æ­£ç¡®ï¼Œæˆ–çº¿è·¯è¢«å¢™ã€‚
3. **éªŒè¯ç è¯†åˆ«ä¸å‡†** â€“ å¼€å¯ `debug=True`ï¼ŒæŸ¥çœ‹ `results/captcha_debug/` ä¸­é—´äº§ç‰©ï¼›å°è¯• `ocr_method="trocr"` æˆ– `"pytesseract"`ã€‚
4. **TraceParts æ‹’ç»è®¿é—®** â€“ é€‚å½“å»¶è¿Ÿè¯·æ±‚ã€åˆ‡æ¢ IP æˆ–ä½¿ç”¨çœŸå®æµè§ˆå™¨æ¨¡å¼ã€‚

---

## License

MIT Â© 2025 now 